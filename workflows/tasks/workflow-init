#!/usr/bin/env bash

# Workflow Init
# Creates a .workflow.yml file in the current directory with sensible defaults

set -euo pipefail

# Get the current directory name for session name
current_dir=$(pwd)
dir_name=$(basename "$current_dir")

# Check if .workflow.yml already exists
if [ -f ".workflow.yml" ]; then
    echo "Error: .workflow.yml already exists in this directory" >&2
    exit 1
fi

# Create .workflow.yml with defaults
cat > .workflow.yml <<EOF
windows:
  - ai: \$WORKFLOW_AI_CLI
  - nvim: nvim
  - bash:
EOF

chmod 644 .workflow.yml

echo "Created .workflow.yml for '$dir_name' session" >&2
echo "Edit .workflow.yml to customize windows and commands" >&2
echo ""
echo "File location: $current_dir/.workflow.yml"
